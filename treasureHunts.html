<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Geolocation</title>
    <link rel="stylesheet" href="treasureHunts.css">
</head>
<body>

    <section class="form-section">


        <form id="form" action="/" method="GET">

            <div class="form-wrapper">

                <h1>
                    Please Input your details and select a Treasure Hunt
                </h1>
                <div class="name-input">
                    <label for="name" class="label-text">Name</label>
                    <input id="name" name="name" type="text" required>
                </div>

                <div class="password-input">
                    <label for="surname" class="label-text">Surname</label>
                    <input id="surname" name="surname" type="text" required>
                </div>

                <div id="error-message"><h1></h1></div>

            </div>



        </form>

    </section>

    <section class="treasure-hunts-section">


        <div id="generated-api-hunts">

        </div>





    </section>



    <script>

        const name = document.getElementById('name');
        const surname = document.getElementById('surname');
        const form = document.getElementById("form");
        const errorElement = document.getElementById("error-message");

        form.addEventListener('submit', (e)=> {
            let messages = [];
            let validLetters = /^[A-Za-z]+$/;
            if(! ((name.value.trim().match(validLetters)) && (surname.value.trim().match(validLetters)))) {
                messages.push("A Valid Name and Surname are required");
            }

            if(messages.length > 0){
                e.preventDefault();
                errorElement.innerText = messages.join(', ');
            }

            e.preventDefault();
            console.log(name.value.trim() + surname.value.trim());

        })


        function fetchTreasureHunts() {

            fetch("https://codecyprus.org/th/api/list")
                .then(response => response.json())
                .then(jsonObject => {

                    let myList = document.getElementById("generated-api-hunts");
                    let listOfTreasureHunts = jsonObject.treasureHunts;

                    // let callURL = "https://codecyprus.org/th/api/start"
                    //
                    //     + "?player=" + playerName
                    //
                    //     + "&app=" + "MyApp"
                    //
                    //     + "&treasure-hunt-id=" + uuid
                    //
                    // ;


                    for(let i = 0; i < listOfTreasureHunts.length; i++){
                        let listItem = document.createElement("div"); //tag name
                        let id = listOfTreasureHunts[i].name;
                        listItem.innerHTML = "<button type=submit class=treasure form=form id="+id+">" + "<h1>" + listOfTreasureHunts[i].name + "</h1>" + "</button";
                        myList.appendChild(listItem);
                    }
                });
        }
        fetchTreasureHunts();



        //
        // fetchTreasureHunts();
        //
        //
        //
        // function getLocation() {
        //
        //     if (navigator.geolocation) {
        //         navigator.geolocation.getCurrentPosition((position) => {
        //
        //             alert("Latitude: " + position.coords.latitude + ", Longitude: " + position.coords.longitude);
        //
        //              // fetch("https://codecyprus.org/th/api/location?session=YOUR_SESSION_ID&latitude=" + position.coords.latitude + "&longitude=" + position.coords.longitude);
        //              //use this when having session ID
        //         });
        //     }
        //     else {
        //         alert("Geolocation is not supported by your browser.");
        //     }
        // }




</script>

</body>
</html>